//  _____  _____  _   _  _____ ______   ___   _____  _____ ______ 
// |  __ \|  ___|| \ | ||  ___|| ___ \ / _ \ |_   _||  ___||  _  \
// | |  \/| |__  |  \| || |__  | |_/ // /_\ \  | |  | |__  | | | |
// | | __ |  __| | . ` ||  __| |    / |  _  |  | |  |  __| | | | |
// | |_\ \| |___ | |\  || |___ | |\ \ | | | |  | |  | |___ | |/ /
//  \____/\____/ \_| \_/\____/ \_| \_|\_| |_/  \_/  \____/ |___/
//
// ---------------------------------------------------------------------------------------------------------------------
//
//                                                  Warning!
// Never modify this file by hand, because it's automatically generated by an external tool and will be overwritten.
//
// ---------------------------------------------------------------------------------------------------------------------

#ifndef {{ guardName }}
#define {{ guardName }}

#include <fstream>
#include <nlohmann/json.hpp>
#include <ostream>
#include <string>
#include <iomanip>

{{ #serializableObjects }}
#include "{{{ includeObjectPath }}}"
{{ /serializableObjects }}

#define LOAD_PRIMITIVE_DATA_TO_FIELD(JSON, OBJECT, FIELD, TYPE) if (!JSON[#FIELD].is_null()) OBJECT.FIELD = JSON[#FIELD].get<TYPE>()
#define SAVE_PRIMITIVE_DATA_TO_JSON(JSON, OBJECT, FIELD) JSON[#FIELD] = OBJECT.FIELD

namespace {{ namespace }}
{
    // DESERIALIZERS
{{ #serializableObjects }}
    static void Deserialize(std::ifstream& fileStream, {{ objectName }}& object)
    {
        nlohmann::json json;
        fileStream >> json;

        {{ #serializableFields }}
        LOAD_PRIMITIVE_DATA_TO_FIELD(json, object, {{ field }}, {{ type }});
        {{ /serializableFields }}
    }
{{ /serializableObjects }}

    // SERIALIZERS
{{ #serializableObjects }}
    static void Serialize(std::ofstream& fileStream, const {{ objectName }}& object)
    {
        nlohmann::json json;

        {{ #serializableFields }}
        SAVE_PRIMITIVE_DATA_TO_JSON(json, object, {{ field }});
        {{ /serializableFields }}

        fileStream << std::setw(3) << json;
    }
{{ /serializableObjects }}
};

#endif //{{ guardName }}